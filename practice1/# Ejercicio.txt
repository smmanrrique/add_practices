# Ejercicio
# Se desea comparar el tiempo de ejecucion de dos algoritmos, AL1 y AL2. Para
# el lo se dispone de dos muestras de datos correspondientes a los tiempos de CPU de
# ejecucion de ambos algoritmos.
# Los datos estan en el fichero: Datos2poblaciones.RData

# Cargamos los datos
load("C:/Users/smmanrrique/3D Objects/unizar/ADD Análisis avanzado de datos/Datos Clases Inferencia (Repaso) y ANOVA-20200926/Datos2poblaciones.RData")

# Graficamos los resultados obtenidos de ambos algs en histogramas
with(Datos, Hist(TiempoAlg1, scale="frequency", breaks="Sturges", col="darkgray"))
with(Datos, Hist(TiempoAlg2, scale="frequency", breaks="Sturges", col="darkgray"))

# Obtenemos un resumen de los datos estadisticos de cada alg.
numSummary(Datos[,c("TiempoAlg1", "TiempoAlg2"), drop=FALSE], statistics=c("mean", "sd", "IQR", "quantiles"), 
  quantiles=c(0,.25,.5,.75,1))

# Graficamos los Boxplot
Boxplot( ~ TiempoAlg1, data=Datos, id=list(method="y"))
Boxplot( ~ TiempoAlg2, data=Datos, id=list(method="y"))


# Creamos un StackedData
StackedData <- stack(Datos[, c("TiempoAlg1","TiempoAlg2")])
names(StackedData) <- c("variable", "factor")


# (1) Realizar pruebas estadisticas tanto graficas como analiticas para establecer la posible normalidad de los datos.



# Podriamos decir que con Shapiro-Wilk normality test el valor de W es mayor a 0.5 por lo que puede darse el caso que sea normal
normalityTest(variable ~ factor, test="shapiro.test", data=StackedData)

 
Tapply(variable ~ factor, var, na.action=na.omit, data=StackedData) # variances by group
var.test(variable ~ factor, alternative='two.sided', conf.level=.95, data=StackedData)


t.test(variable~factor, alternative='two.sided', conf.level=.95, var.equal=FALSE, data=StackedData)
t.test(variable~factor, alternative='two.sided', conf.level=.95, var.equal=TRUE, data=StackedData)


# (2) En el caso de apreciarse normalidad en los datos, ¿cuales son las estimaciones de los parametros de las distribuciones normales? 


# (3) Representar graficamente un box-plot conjunto de los dos grupos de datos e interpretarlo.

# Graficamos ambos alg
Boxplot( ~ variable, data=StackedData, id=list(method="y"))
Boxplot(variable~factor, data=StackedData, id=list(method="y"))

# (4) ¿Puede asumirse intuitivamente que los tiempos de ejecucion de los dos algoritmos son similares?












